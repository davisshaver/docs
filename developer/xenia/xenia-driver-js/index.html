<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">   
    <link rel="shortcut icon" href="../../../img/favicon.ico">

    <title>Xenia Driver - Coral Project Docs</title>

    <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../../css/base.css" rel="stylesheet">
    <link href="../../../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">


    <link href="../../../css/extra.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
    <script>
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-73335347-3', 'docs.coralproject.net');
    ga('send', 'pageview');
    </script>
    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../../..">Coral Project Docs</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Products <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../products/">User Guide</a>
</li>

                        
                            
<li >
    <a href="../../../products/ask/">Ask</a>
</li>

                        
                            
<li >
    <a href="../../../products/talk/">Talk</a>
</li>

                        
                            
<li >
    <a href="../../../products/trust/">Trust</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developers <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../">Introduction</a>
</li>

                        
                            
<li >
    <a href="../../architectural_overview/">Architectural overview</a>
</li>

                        
                            
<li >
    <a href="../../quickstart/install/">Installing Coral Ecosystem</a>
</li>

                        
                            
<li >
    <a href="../../developer_setup/">Developer tools setup</a>
</li>

                        
                            
<li >
    <a href="../../cay/">Cay</a>
</li>

                        
                            
<li >
    <a href="../../elkhorn/">Elkhorn</a>
</li>

                        
                            
<li >
    <a href="../../pillar/">Pillar</a>
</li>

                        
                            
<li >
    <a href="../../sponge/">Sponge</a>
</li>

                        
                            
<li >
    <a href="../">Xenia</a>
</li>

                        
                            
<li class="active">
    <a href="./">Xenia Driver</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Get Involved <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../contribute/">Introduction</a>
</li>

                        
                            
<li >
    <a href="../../../contribute/writing_code/">Contribute code</a>
</li>

                        
                            
<li >
    <a href="../../../contribute/docs_style_guide/">Contribute to moderation style guide</a>
</li>

                        
                            
<li >
    <a href="../../../contribute/writing_documentation/">Write documentation</a>
</li>

                        
                            
<li >
    <a href="../../../contribute/coding_style_guide/">Code best practices</a>
</li>

                        
                            
<li >
    <a href="../../../contribute/reporting_bugs/">Submit feature requests</a>
</li>

                        
                            
<li >
    <a href="../../../contribute/reporting_bugs/">Report bugs</a>
</li>

                        
                            
<li >
    <a href="../../../contribute/code_of_conduct/">Our Code of Conduct</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contact <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../contact/support/">Technical Support</a>
</li>

                        
                            
<li >
    <a href="../../../contact/faq/">FAQ</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li>
                        <a href="https://github.com/coralproject/docs/">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="first-level active"><a href="#xenia-driver">Xenia Driver</a></li>
        
            <li class="second-level"><a href="#example-data-visualization">Example data visualization</a></li>
            
        
    
        <li class="first-level "><a href="#xenia-driver-installation">Xenia Driver installation</a></li>
        
            <li class="second-level"><a href="#import-and-use">Import and use</a></li>
            
        
    
        <li class="first-level "><a href="#xenia-driver-api">Xenia Driver API</a></li>
        
            <li class="second-level"><a href="#list-of-queries">List of queries</a></li>
            
                <li class="third-level"><a href="#xeniadriverbaseurl-auth-queryparams-reqparams">XeniaDriver(baseURL, auth [, queryParams] [, reqParams])</a></li>
            
                <li class="third-level"><a href="#addqueryquerydata">addQuery(queryData)</a></li>
            
                <li class="third-level"><a href="#collectionname">collection(name)</a></li>
            
                <li class="third-level"><a href="#execqueryname-params">exec(queryName, params)</a></li>
            
                <li class="third-level"><a href="#getqueries">getQueries()</a></li>
            
                <li class="third-level"><a href="#getqueryname">getQuery(name)</a></li>
            
                <li class="third-level"><a href="#savequeryname">saveQuery(name)</a></li>
            
                <li class="third-level"><a href="#deletequeryname">deleteQuery(name)</a></li>
            
                <li class="third-level"><a href="#limitn">limit(n)</a></li>
            
                <li class="third-level"><a href="#skipn">skip(n)</a></li>
            
                <li class="third-level"><a href="#samplen">sample(n)</a></li>
            
                <li class="third-level"><a href="#projectfields">project(fields)</a></li>
            
                <li class="third-level"><a href="#includefieldnames">include(fieldNames)</a></li>
            
                <li class="third-level"><a href="#excludefieldnames">exclude(fieldNames)</a></li>
            
                <li class="third-level"><a href="#matchquery">match(query)</a></li>
            
                <li class="third-level"><a href="#redactquery">redact(query)</a></li>
            
                <li class="third-level"><a href="#unwindpath-includearrayindex-preservenullandemptyarrays">unwind(path, includeArrayIndex, preserveNullAndEmptyArrays)</a></li>
            
                <li class="third-level"><a href="#groupgroups">group(groups)</a></li>
            
                <li class="third-level"><a href="#sortorder">sort(order)</a></li>
            
                <li class="third-level"><a href="#joincollection-field-matchingfield-name">join(collection, field, matchingField, name)</a></li>
            
        
            <li class="second-level"><a href="#development">Development</a></li>
            
        
            <li class="second-level"><a href="#test">Test</a></li>
            
        
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="xenia-driver">Xenia Driver</h1>
<p><a href="https://github.com/coralproject/xenia-driver-js">Xenia-driver-js</a> is a JavaScript library that performs queries to <a href="https://github.com/coralproject/xenia">Xenia</a> from the browser, or from a Node.js application.</p>
<h2 id="example-data-visualization">Example data visualization</h2>
<p>During a Hackathon event, one of our Coral Project developers put together an example data visualization, built using the <a href="https://d3js.org/">d3.js</a> JavaScript library. You can view <a href="http://coralproject.github.io/hackathon/datavis.html">the example here</a>, and see the code the developer used <a href="https://github.com/coralproject/hackathon/blob/gh-pages/datavis.html">on GitHub</a>.</p>
<h1 id="xenia-driver-installation">Xenia Driver installation</h1>
<pre><code>$ npm install --save xenia-driver
</code></pre>

<h2 id="import-and-use">Import and use</h2>
<pre><code>import XeniaDriver from 'xenia-driver'

// Configure your instance
const xenia = XeniaDriver(baseUrl, {username: 'user', password: 'pass'})

// Use the driver
xenia()
  .match({ 'category': 'sports' })
  .include(['comments', 'name'])
  .limit(14)
  .skip(8)
.join('my_collection')
.exec().then(data =&gt; console.log(data.results))
</code></pre>

<h1 id="xenia-driver-api">Xenia Driver API</h1>
<h2 id="list-of-queries">List of queries</h2>
<ul>
<li><a href="#xeniadriverbaseurl-auth-queryparams-reqparams">XeniaDriver(baseURL, auth [, queryParams] [, reqParams])</a></li>
<li><a href="#addqueryquerydata">addQuery(queryData)</a></li>
<li><a href="#collectionname">collection(name)</a></li>
<li><a href="#execqueryname-params">exec(queryName, params)</a></li>
<li><a href="#getqueries">getQueries()</a></li>
<li><a href="#getqueryname">getQuery(name)</a></li>
<li><a href="#savequeryname">saveQuery(name)</a></li>
<li><a href="#deletequeryname">deleteQuery(name)</a></li>
<li><a href="#limitn">limit(n)</a></li>
<li><a href="#skipn">skip(n)</a></li>
<li><a href="#samplen">sample(n)</a></li>
<li><a href="#projectfields">project(fields)</a></li>
<li><a href="#includefieldnames">include(fieldNames)</a></li>
<li><a href="#excludefieldnames">exclude(fieldNames)</a></li>
<li><a href="#matchquery">match(query)</a></li>
<li><a href="#redactquery">redact(query)</a></li>
<li><a href="#unwindpath-includearrayindex-preservenullandemptyarrays">unwind(path, includeArrayIndex, preserveNullAndEmptyArrays)</a></li>
<li><a href="#groupgroups">group(groups)</a></li>
<li><a href="#sortorder">sort(order)</a></li>
<li><a href="#joincollection-field-matchingfield-name">join(collection, field, matchingField, name)</a></li>
</ul>
<h3 id="xeniadriverbaseurl-auth-queryparams-reqparams">XeniaDriver(baseURL, auth [, queryParams] [, reqParams])</h3>
<p>Creates a new <code>XeniaDriver</code> instance</p>
<ul>
<li><code>baseURL</code> (String) - Xenia server base url</li>
<li><code>auth</code> (String | Object) - basic authentication credentials. If it&rsquo;s a string it should be the Basic authentication value for the Authorization header</li>
<li><code>[auth.username]</code> (String) - Auth username</li>
<li><code>[auth.password]</code> (String) - Auth password</li>
<li><code>[queryParams]</code> (Object) - It can hold a Xenia raw query to perform before the rest of the queries</li>
<li><code>[reqParams]</code> (Object) - Add your own parameters to the request</li>
</ul>
<pre><code class="js">const xenia = XeniaDriver('https://my-xenia-url.com', 'Basic kewlrgm;we4p3jtqpwfawmeklfdmdsadlm')
</code></pre>

<h3 id="addqueryquerydata">addQuery(queryData)</h3>
<p>Initialize a query. When the xenia constructor runs it will call this function for you. Use it for adding more than one query in the same request.</p>
<ul>
<li><code>[queryData]</code> (Object) - Provide the configuration for the new query</li>
</ul>
<pre><code class="js">xenia()
  .limit(20).skip(10)
  .addQuery().match({'name': 'John Doe'})
  .exec().then(data =&gt; console.log(data))
</code></pre>

<h3 id="collectionname">collection(name)</h3>
<p>Set the current query collection</p>
<ul>
<li><code>name</code> (String) - collection name</li>
</ul>
<pre><code class="js">xenia()
  .collection('users')
  .exclude(['_id'])
  .exec().then(data =&gt; console.log(data))
</code></pre>

<h3 id="execqueryname-params">exec(queryName, params)</h3>
<p>Executes the request</p>
<ul>
<li><code>[name]</code> (string) - Executes a saved query by name</li>
<li><code>[params]</code> (Object) - Custom request parameters</li>
</ul>
<pre><code class="js">xenia().exec('my_saved_query').then(data =&gt; console.log(data))

// Or

xenia().limit(20).skip(10)
  .exec().then(data =&gt; console.log(data))
  .catch(err =&gt; console.log(err))
</code></pre>

<h3 id="getqueries">getQueries()</h3>
<p>Get a list of available queries</p>
<pre><code class="js">xenia().getQueries().then(data =&gt; console.log(data))
</code></pre>

<h3 id="getqueryname">getQuery(name)</h3>
<p>Get a specific query document</p>
<ul>
<li><code>name</code> (String) - query name</li>
</ul>
<pre><code class="js">xenia().getQuery('my_query').then(data =&gt; console.log(data))
</code></pre>

<h3 id="savequeryname">saveQuery(name)</h3>
<p>Save a new query</p>
<ul>
<li><code>[name]</code> (String) - query name</li>
</ul>
<pre><code class="js">xenia()
  .collection('users')
  .limit(5).include(['name', 'avatar'])
  .saveQuery('first users').then(data =&gt; console.log(data))
</code></pre>

<h3 id="deletequeryname">deleteQuery(name)</h3>
<p>Delete a query</p>
<ul>
<li><code>[name]</code> (String) - query name</li>
</ul>
<pre><code class="js">xenia()
  .deleteQuery('first users')
  .then(data =&gt; console.log(data))
</code></pre>

<h3 id="limitn">limit(n)</h3>
<p>Limit the amount of retrieved documents</p>
<ul>
<li><code>[n]</code> (Number) - number of docs to retrieve, default: 20</li>
</ul>
<pre><code class="js">xenia().limit(15)
</code></pre>

<h3 id="skipn">skip(n)</h3>
<p>Skip the first n documents</p>
<ul>
<li><code>[n]</code> (Number) - number of skipped docs, default: 0</li>
</ul>
<pre><code class="js">xenia().skip(12)
</code></pre>

<h3 id="samplen">sample(n)</h3>
<p>Return a document sample from the collection</p>
<ul>
<li><code>[n]</code> (Number) - number of sample docs, default: 20</li>
</ul>
<pre><code class="js">xenia().sample(50)
</code></pre>

<h3 id="projectfields">project(fields)</h3>
<p>Include and exclude fields from the result using the $project aggregation pipeline operator. You&rsquo;ll find out that <code>Xenia#include</code> and <code>Xenia#exclude</code> can be easier to use for most scenarios.</p>
<ul>
<li><code>fields</code> (Object) - Aggregation fields object</li>
</ul>
<pre><code class="js">xenia()
  .project({'name': true, '_id': false, 'comments': { 'country': true}})
</code></pre>

<h3 id="includefieldnames">include(fieldNames)</h3>
<p>Whitelist retrieved fields</p>
<ul>
<li><code>fieldNames</code> (Array) - fields you want to retrieve</li>
</ul>
<pre><code class="js">xenia().include(['name', 'avatar'])
</code></pre>

<h3 id="excludefieldnames">exclude(fieldNames)</h3>
<p>Blacklist retrieved fields</p>
<ul>
<li><code>fieldNames</code> (Array) - fields you don&rsquo;t want to retrieve</li>
</ul>
<pre><code class="js">xenia().exclude(['age', 'gender'])
</code></pre>

<h3 id="matchquery">match(query)</h3>
<p>Performs a match command on the aggregation pipeline</p>
<ul>
<li><code>query</code> (Object) - Match parameters</li>
</ul>
<pre><code class="js">xenia().match({ 'name': 'John', 'status': { '$in' : ['user', 'admin']} })
</code></pre>

<h3 id="redactquery">redact(query)</h3>
<p>Performs a redact command on the aggregation pipeline</p>
<ul>
<li><code>query</code> (Object) - Redact parameters</li>
</ul>
<pre><code class="js">xenia().redact({ $cond: {
  if: { $gt: [ { $size: { $setIntersection: [ &quot;$tags&quot;, userAccess ] } }, 0 ] },
  then: &quot;$$DESCEND&quot;,
  else: &quot;$$PRUNE&quot;
}})
</code></pre>

<h3 id="unwindpath-includearrayindex-preservenullandemptyarrays">unwind(path, includeArrayIndex, preserveNullAndEmptyArrays)</h3>
<p>Performs a unwind command on the aggregation pipeline - Deconstructs an array field from the input documents to output a document for each element</p>
<ul>
<li><code>path</code> (Object | String) - Field path</li>
<li><code>[includeArrayIndex]</code> (String) - arrayIndex name</li>
<li><code>[preserveNullAndEmptyArrays]</code> (Boolean) - preserve null and empty arrays, default false</li>
</ul>
<pre><code class="js">xenia().unwind('$comments')
</code></pre>

<h3 id="groupgroups">group(groups)</h3>
<p>Group documents</p>
<ul>
<li><code>groups</code> (Object) - group object</li>
</ul>
<pre><code class="js">xenia().group({ _id : { month: { $month: '$date' } })
</code></pre>

<h3 id="sortorder">sort(order)</h3>
<p>Sort documents by fields</p>
<ul>
<li><code>order</code> (Object|Array) - how to sort the data</li>
</ul>
<pre><code class="js">xenia().sort(['name', 1])

// Or

xenia.sort({'name': 1, 'statistics.comments.count': -1})
</code></pre>

<h3 id="joincollection-field-matchingfield-name">join(collection, field, matchingField, name)</h3>
<p>Creates a new query joining the actual one using the save method from Xenia</p>
<ul>
<li><code>collection</code> (String) - The collection you want to join</li>
<li><code>[field]</code> (String) - The matching field in the collection you want to join, default: _id</li>
<li><code>[matchingField]</code> (String) - The field to match in your actual collection, default: same as field parameter</li>
<li><code>[name]</code> (String) - The field name on the results, default: list</li>
</ul>
<pre><code class="js">xenia().collection('comments')
.include(['body', 'asset_id']).limit(5)

.join('assets', '_id', 'asset_id', 'asset')

.include(['section']).exec()
</code></pre>

<h2 id="development">Development</h2>
<pre><code>$ npm start
</code></pre>
<h2 id="test">Test</h2>
<pre><code>$ npm test
</code></pre></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../../../js/jquery-1.10.2.min.js"></script>
    <script src="../../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../../..';
    </script>
    <script data-main="../../../mkdocs/js/search.js" src="../../../mkdocs/js/require.js"></script>
    <script src="../../../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
